<!DOCTYPE html>
<html lang="ja">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="UTF-8">
    <title>Quiz App Complete</title>

<style>
body{
  background:#f4f6fb;
  font-family:sans-serif;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
}
#app{
  width:100%;
  max-width:440px;
  margin:0 12px;
  background:#fff;
  border-radius:12px;
  box-shadow:0 10px 30px rgba(0,0,0,0.1);
  padding:20px;
}

/* ãƒ¡ã‚¤ãƒ³ã‚¿ã‚¤ãƒˆãƒ« */
.game-title {
  font-size: clamp(2rem, 6vw, 2.5rem);  /* ç”»é¢å¹…ã«å¿œã˜ã¦è‡ªå‹•ç¸®å° */
  line-height: 1.2;
  word-break: keep-all;   /* å˜èªã®é€”ä¸­ã§æ”¹è¡Œã•ã›ãªã„ */
  margin-bottom: 10px;
}

/* ã‚µãƒ–ã‚¿ã‚¤ãƒˆãƒ« */
.subtitle {
  font-size: clamp(1rem, 4vw, 1.2rem);    /* ç”»é¢å¹…ã«å¿œã˜ã¦è‡ªå‹•ç¸®å° */
  opacity: 0.8;
  margin-bottom: 24px;
  word-break: keep-all;
}

/* screens */
.screen{ display:none; }
.screen.active{ display:block; }

/* genre */
.genre-btn{
  width:100%;
  padding:12px;
  margin-bottom:10px;
  border-radius:8px;
  border:1px solid #ddd;
  background:#fafafa;
  cursor:pointer;
}
.genre-btn:hover{ background:#eef2ff; }

/* header */
#header{
  display:flex;
  justify-content:space-between;
  margin-bottom:16px;
  font-size:14px;
}
#score{ font-weight:bold; color:#4f46e5; }

/* question */
#question{
  font-size:18px;
  margin-bottom:16px;
}

/* choices */
.choice{
  width:100%;
  padding:12px;
  margin-bottom:8px;
  border-radius:8px;
  border:1px solid #ddd;
  background:#fafafa;
  cursor:pointer;
  transition:0.2s;
}
.choice:hover{ background:#eef2ff; }
.choice.correct{
  background:#dcfce7;
  border-color:#22c55e;
  animation: pop 0.3s ease;
}
.choice.wrong{
  background:#fee2e2;
  border-color:#ef4444;
}

/* input */
#textAnswer{
  width:100%;
  padding:12px;
  font-size:16px;
  border-radius:8px;
  border:1px solid #ddd;
}

/* animation */
@keyframes popIn {
  0% {
    transform: scale(0.8);
    opacity: 0;
  }
  60% {
    transform: scale(1.1);
    opacity: 1;
  }
  100% {
    transform: scale(1);
    opacity: 1;
  }
}

.button-enter {
  animation: popIn 0.4s ease forwards;
  animation-delay: 1s;
  opacity: 0;
}


/* feedback */
#feedback{
  margin-top:12px;
  min-height:28px;
  font-weight:bold;
}

/* button */
button.action{
  margin-top:16px;
  width:100%;
  padding:12px;
  border:none;
  border-radius:8px;
  background:#4f46e5;
  color:#fff;
  font-size:16px;
  padding:14px;
  cursor:pointer;
}
button.action:hover{ background:#4338ca; }

/* result */
.title-badge{
  margin:16px auto;
  padding:12px;
  width:80%;
  text-align:center;
  border-radius:20px;
  background:#eef2ff;
  font-weight:bold;
}

.flash {
  animation: flash 0.4s ease;
}

@keyframes flash {
  0%   { background-color: #ffffff; }
  50%  { background-color: #dcfce7; }
  100% { background-color: #ffffff; }
}

#effectText {
  position: fixed;
  top: 40%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 32px;
  font-weight: bold;
  color: #22c55e;
  opacity: 0;
  pointer-events: none;
  z-index: 999;
}

.show-effect {
  animation: popText 0.6s ease forwards;
}

@keyframes popText {
  0% {
    transform: translate(-50%, -50%) scale(0.8);
    opacity: 0;
  }
  50% {
    transform: translate(-50%, -50%) scale(1.1);
    opacity: 1;
  }
  100% {
    transform: translate(-50%, -50%) scale(1);
    opacity: 0;
  }
}

.shake {
  animation: shake 0.4s;
}

@keyframes shake {
  0%   { transform: translateX(0); }
  20%  { transform: translateX(-6px); }
  40%  { transform: translateX(6px); }
  60%  { transform: translateX(-4px); }
  80%  { transform: translateX(4px); }
  100% { transform: translateX(0); }
}

.title-animate {
  animation: titleIn 0.8s ease-out forwards;
}

@keyframes titleIn {
  0% {
    transform: scale(0.5);
    opacity: 0;
  }
  60% {
    transform: scale(1.1);
    opacity: 1;
  }
  100% {
    transform: scale(1);
    opacity: 1;
  }
}

button.secondary{
  background:#e5e7eb;
  color:#111827;
}
button.secondary:hover{
  background:#d1d5db;
}

@keyframes rainbowFlash {
  0% { background: red; }
  20% { background: orange; }
  40% { background: yellow; }
  60% { background: green; }
  80% { background: blue; }
  100% { background: violet; }
}

body.rainbow {
  animation: rainbowFlash 1s linear infinite;
}

/* ã‚¿ã‚¤ãƒˆãƒ«ç”»é¢ */
#titleScreen {
  display: none; /* ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆéè¡¨ç¤º */
  flex-direction: column;
  justify-content: center;
  align-items: center;
  text-align: center;
  min-height: 400px;
  padding: 20px;
  box-sizing: border-box;
}

#titleScreen.active {
  display: flex; /* active ã®ã¨ãã ã‘è¡¨ç¤º */
}

.title-enter {
  animation: titleEnter 0.8s ease-out forwards;
}

@keyframes titleEnter {
  0% {
    transform: scale(0.6);
    opacity: 0;
  }
  70% {
    transform: scale(1.1);
    opacity: 1;
  }
  100% {
    transform: scale(1);
  }
}

.subtitle-enter {
  animation: fadeIn 0.6s ease forwards;
  animation-delay: 0.6s;
  opacity: 0;
}

.button-enter {
  animation: popIn 0.4s ease forwards;
  animation-delay: 1s;
  opacity: 0;
}

@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

</style>
</head>

<body>
<div id="app">
  <audio id="seCorrect" src="correct.mp3"></audio>
  <audio id="seWrong" src="wrong.mp3"></audio>
  <audio id="sePerfect" src="perfect.mp3"></audio>
  <audio id="seGood" src="good.mp3"></audio>
  <audio id="seBad" src="bad.mp3"></audio>
  <audio id="seHell" src="hell.mp3"></audio>
  <audio id="seStart" src="start.mp3"></audio>
  <audio id="seSelect" src="select.mp3"></audio>

  <!-- ã‚¿ã‚¤ãƒˆãƒ«ç”»é¢ -->
  <div id="titleScreen" class="screen active">
    <h1 class="game-title title-enter">ãƒ‘ãƒã‚¹ãƒ­ã‚¯ã‚¤ã‚º</h1>
    <p class="subtitle subtitle-enter">çŸ¥è­˜ã¨ãƒ’ã‚­ã§é ‚ç‚¹ã‚’æ´ã‚â•</p>
    <button class="action button-enter" onclick="goToGenre()">ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
  </div>

  <!-- ã‚¸ãƒ£ãƒ³ãƒ«é¸æŠç”»é¢ -->
  <div id="genreScreen" class="screen">
    <h2>ã‚¸ãƒ£ãƒ³ãƒ«é¸æŠ</h2>
    <button class="genre-btn" onclick="startQuiz('html')">ãƒ‘ãƒãƒ³ã‚³ãƒ‘ãƒã‚¹ãƒ­ç”¨èª</button>
    <button class="genre-btn" onclick="startQuiz('css')">ãƒ‘ãƒã‚¹ãƒ­æ©Ÿç¨®å†…å®¹</button>
    <button class="genre-btn" onclick="startQuiz('js')">ã‚¯ãƒƒã‚­ãƒ¼ä¸Šç´š</button>
  </div>

  <!-- quiz -->
  <div id="quizScreen" class="screen">
    <div id="header">
      <div id="progress"></div>
      <div id="score"></div>
    </div>

    <div id="question"></div>
    <div id="choices"></div>
    <div id="feedback"></div>

    <button id="submitBtn" class="action" style="display:none;">å›ç­”</button>
    <button id="nextBtn" class="action" style="display:none;">æ¬¡ã¸</button>
  </div>

  <!-- result -->
  <div id="resultScreen" class="screen">
    <h2>çµæœ</h2>
    <div id="title" class="title-badge"></div>
    <p id="resultText" style="text-align:center;"></p>

    <button class="action" onclick="restartQuiz()">ã‚‚ã†ä¸€å›</button>
    <button class="action secondary" onclick="backToGenre()">ã‚¸ãƒ£ãƒ³ãƒ«é¸æŠã«æˆ»ã‚‹</button>

  </div>
  <!-- â˜… æ­£è§£æ¼”å‡ºç”¨ -->
  <div id="effectText"></div>
</div>

<script>
/* ===== data ===== */
const QUIZ_DATA = {
  html:[
    {type:"text", q:"å¤§å½“ã‚Šç¢ºç‡ãŒ100åˆ†ã®1å‰å¾Œã¨é«˜ãã€æ°—è»½ã«éŠã¹ã‚‹ã‚¹ãƒšãƒƒã‚¯ã®æ©Ÿç¨®ã®ç·ç§°ã¯ï¼Ÿ",a:["ç”˜ãƒ‡ã‚¸"]},
    {type:"text", q:"å¤§å½“ã‚Šã®æˆç«‹ã‚’ã€å½“è©²ã¾ãŸã¯æ¬¡ã®å›è»¢ãªã©ã«ãƒ©ãƒ³ãƒ—ã‚„éŸ³ã§å‘ŠçŸ¥ã™ã‚‹ã“ã¨ã‚’ãªã‚“ã¨ã„ã†ï¼Ÿ",a:["å®Œå…¨å‘ŠçŸ¥"]},
    {type:"text", q:"å³ãƒªãƒ¼ãƒ«ä¸‹æ®µãƒã‚§ãƒªãƒ¼ä»˜ã7å›³æŸ„ã®ç•¥ã‚’ãªã‚“ã¨ã„ã†ï¼Ÿ",a:["ã‚²ãƒã‚§ãƒŠ"]},
    {type:"text", q:"å¤§å½“ã‚Šæ™‚ã«ãƒ¬ãƒãƒ¼ã‚ªãƒ³ã¨åŒæ™‚ã«å‘ŠçŸ¥ãŒç™ºç”Ÿã™ã‚‹ã“ã¨ã‚’ãªã‚“ã¨ã„ã†ï¼Ÿ",a:["å…ˆå‘ŠçŸ¥"]},
    {type:"text", q:"ç²å¾—ã—ãŸç‰ãƒ»ãƒ¡ãƒ€ãƒ«ã‚’è¨ˆæ¸¬ã™ã‚‹æ©Ÿæ¢°ã‚’ãªã‚“ã¨ã„ã†ï¼Ÿ",a:["ã‚¸ã‚§ãƒƒãƒˆã‚«ã‚¦ãƒ³ã‚¿ãƒ¼"]},
    {type:"text", q:"è¨­å®šã‚’å‰æ—¥ã‹ã‚‰å¤‰æ›´ã—ã¦ã„ãªã„ã“ã¨ã‚’ãªã‚“ã¨ã„ã†ï¼Ÿ",a:["æ®ãˆç½®ã"]},
  ],
  css:[
    {type:"choice", q:"<b>ã€ãƒ‘ãƒã‚¹ãƒ­ é©å‘½æ©Ÿãƒ´ã‚¡ãƒ«ãƒ´ãƒ¬ã‚¤ãƒ´ã€</b><br>ATã€Œé©å‘½ãƒ©ãƒƒã‚·ãƒ¥ã€çªå…¥ã®ãƒ¡ã‚¤ãƒ³ãƒ«ãƒ¼ãƒˆã«ãªã‚‹ã€Œé©å‘½ãƒœãƒ¼ãƒŠã‚¹ï¼ˆ50Gï¼‹Î±ã€ç´”å¢—ç´„7.2æš/Gï¼‰ã€ã¯ã€ã©ã‚“ãªæ¡ä»¶ã‚’é”æˆã™ã‚‹ã¨é©å‘½ãƒ©ãƒƒã‚·ãƒ¥ã«çªå…¥ã™ã‚‹ï¼Ÿ",
    c:["æ‰•ã„å‡ºã—æšæ•°666æšåˆ°é”","HOLDç™ºå‹•5å›é”æˆ","ã„ã¤ã‹ãƒ‘ãƒã‚¹ãƒ­ç•Œã«é©å‘½ã‚’èµ·ã“ã™è¦šæ‚Ÿã‚’æ±ºã‚ã‚‹","50Gæ¶ˆåŒ–å¾Œãƒ™ãƒ«5é€£ç¶šæˆç«‹"],
    a:0,
    img:"images/kakumei.jpg",},

    {type:"choice", q:"<b>ã€ãƒ‘ãƒã‚¹ãƒ­ é©å‘½æ©Ÿãƒ´ã‚¡ãƒ«ãƒ´ãƒ¬ã‚¤ãƒ´ã€</b><br>1ã‚»ãƒƒãƒˆ10ï½100Gï¼‹Î±ã€ç¶™ç¶šç‡77ï¼…ã®ATã€Œé©å‘½ãƒ©ãƒƒã‚·ãƒ¥ã€ã€‚æ¶ˆåŒ–ä¸­ã¯ãƒ¬ã‚¢å½¹ãªã©ã§ã‚²ãƒ¼ãƒ æ•°ï¼†ã‚»ãƒƒãƒˆæ•°ã‚’ä¸Šä¹—ã›ã™ã‚‹ãŒã€æœ€ä¸Šä½ATã€Œè¶…é©å‘½ãƒ©ãƒƒã‚·ãƒ¥ã€ã«ç§»è¡Œã™ã‚‹ã«ã¯ã©ã†ã™ã‚Œã°ã„ã„ï¼Ÿ",
    c:["ç¶™ç¶šã‚¸ãƒ£ãƒƒã‚¸ã®ãƒãƒ©ã‚­ãƒªãƒãƒ£ãƒ¬ãƒ³ã‚¸å¤±æ•—å¾Œ5Gä»¥å†…ã§å¼•ãæˆ»ã™","ã‚¤ãƒƒãƒ‘ã‚¤ãƒã‚»ãƒã‚¹ã‚«ï¼Ÿæ¼”å‡ºã‚’ç™ºç”Ÿã•ã›ã‚‹","3ã‚»ãƒƒãƒˆç›®ã‚’ç¶™ç¶šã•ã›ã‚‹","ç›£è¦–ã‚«ãƒ¡ãƒ©ã«å‘ã‹ã£ã¦åœŸä¸‹åº§ã™ã‚‹"],
    a:2,
    img:"images/kakumei_rush.jpg",},

    {type:"choice", q:"<b>ã€ã‚¹ãƒã‚¹ãƒ­ åŒ—æ–—ã®æ‹³ã€</b><br>BBçµ‚äº†æ™‚ã«ã‚µãƒ–æ¶²æ™¶ã‚’ã‚¿ãƒƒãƒã™ã‚‹ã¨èã“ãˆã‚‹ãƒœã‚¤ã‚¹ã§ã€ã‚±ãƒ³ã‚·ãƒ­ã‚¦ã¨ãƒ¦ãƒªã‚¢ä»¥å¤–ã§æœ€ã‚‚é«˜è¨­å®šã«æœŸå¾…ã§ãã‚‹ã®ã¯ï¼Ÿ",
    c:["ã‚¢ãƒŸãƒ","ãƒˆã‚­","ã‚¸ãƒ£ã‚®","ãƒªãƒ³"],
    a:0,
    img:"images/hokuto_sub.jpg",},

    {type:"choice", q:"<b>ã€ã‚¹ãƒã‚¹ãƒ­ åŒ—æ–—ã®æ‹³ã€</b><br>å¼±ãƒã‚§ãƒªãƒ¼ã‚’å¼•ã„ãŸå¾Œã§ã©ã‚“ãªå±•é–‹ã«ãªã‚‹ã¨é«˜è¨­å®šã®ãƒãƒ£ãƒ³ã‚¹ï¼Ÿ",
    c:["ã‚±ãƒ³ã‚·ãƒ­ã‚¦ãŒã§ã‚“ãã‚Šè¿”ã—ã‚’ã™ã‚‹","ã‚¦ã‚¤ã‚°ãƒ«ãƒãƒˆãƒ«ã«ç™ºå±•","BBå½“é¸","ãƒªãƒ³ãŒã—ã‚ƒãŒã¿è¾¼ã‚€"],
    a:2,
    img:"images/hokuto_kyoutye.jpg",},

    {type:"choice", q:"<b>ã€ã‚¹ãƒã‚¹ãƒ­ åŒ—æ–—ã®æ‹³ã€</b><br>é€šå¸¸æ™‚300Gã€777Gã€800Gã«åˆ°é”ã—ãŸã¨ãã¯ã©ã‚“ãªæŠ½é¸ãŒè¡Œã‚ã‚Œã‚‹ï¼Ÿ",
    c:["å¤©äº•çŸ­ç¸®æŠ½é¸","é«˜ç¢ºç§»è¡ŒæŠ½é¸","æ±šç‰©æ¶ˆæ¯’æŠ½é¸","BBç›´æ’ƒæŠ½é¸"],
    a:0,
    img:"images/hokuto_tyuusen.jpg",},

    {type:"choice", q:"<b>ã€ã‚¹ãƒã‚¹ãƒ­ åŒ—æ–—ã®æ‹³ã€</b><br>é€šå¸¸æ™‚ã®ãƒãƒƒãƒˆæ¼”å‡ºã§ã¯ã€Œã©ã‚“ãªç¼¶ã€ã‚’è½ã¨ã™ã¨æ¿€ã‚¢ãƒ„ï¼ˆBBå½“é¸ã®æœŸå¾…å¤§ï¼‰ï¼Ÿ",
    c:["ç™½ç¼¶","é»’ç¼¶","é’ç¼¶","èµ¤ç¼¶"],
    a:1,
    img:"images/hokuto_bad.jpg",},

    {type:"text", q:"<b>ã€ã‚¹ãƒã‚¹ãƒ­ ãƒ¢ãƒ³ã‚­ãƒ¼ã‚¿ãƒ¼ãƒ³Vã€</b><br>é’å³¶SGã®ãƒ©ã‚¦ãƒ³ãƒ‰ç”»é¢ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã¯ã€Œç§æœã€ã€Œãƒ‰ãƒ¬ã‚¹ã€ã€Œé’å³¶ï¼†æ³¢å¤šé‡ã€ã‚ã¨ä¸€ã¤ã¯ï¼Ÿ",
    a:["ãƒ¬ãƒ¼ã‚¹æœ","ãƒ¬ãƒ¼ã‚¹"],
    img:"images/monki_aosima.jpg",},

    {type:"choice", q:"<b>ã€ã‚¹ãƒã‚¹ãƒ­ ãƒ¢ãƒ³ã‚­ãƒ¼ã‚¿ãƒ¼ãƒ³Vã€</b><br>è¶…æŠœãƒãƒ£ãƒ¬ãƒ³ã‚¸ä¸­ã®ãƒšãƒ©ã®ATå½“é¸ç‡ã¯ï¼Ÿ",
    c:["8.4%","9.4%","10.4%","11.4%"],
    a:1,
    img:"images/monki_tyoubatu.jpg",},

    {type:"text", q:"<b>ã€ã‚¹ãƒã‚¹ãƒ­ ãƒ¢ãƒ³ã‚­ãƒ¼ã‚¿ãƒ¼ãƒ³Vã€</b><br>è¶…æŠœãƒãƒ£ãƒ¬ãƒ³ã‚¸å¤±æ•—æ™‚ã®ä¸€éƒ¨ã§çªå…¥ã™ã‚‹ãƒ—ãƒ¬ãƒŸã‚¢ãƒ CZã¯ï¼Ÿ",
    a:["ã‚°ãƒ©ãƒ³ãƒ‰ã‚¹ãƒ©ãƒ ãƒãƒ£ãƒ¬ãƒ³ã‚¸"],
    img:"images/monki_puremia.jpg",},

    {type:"text", q:"<b>ã€ã‚¹ãƒã‚¹ãƒ­ ãƒ¢ãƒ³ã‚­ãƒ¼ã‚¿ãƒ¼ãƒ³Vã€</b><br>ã‚°ãƒ©ãƒ³ãƒ‰ã‚¹ãƒ©ãƒ ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã«æˆåŠŸã™ã‚‹ã¨ä½•ãŒç¢ºå®šã™ã‚‹ï¼Ÿ",
    a:["æ³¢å¤šé‡ãƒ•ãƒªãƒ¼ã‚º","é’å³¶SPãƒ•ãƒªãƒ¼ã‚º"],
    img:"images/monki_gurasuraseikou.jpg",},

    {type:"choice", q:"<b>ã€ã‚¹ãƒã‚¹ãƒ­ Læ±äº¬å–°ç¨®ã€</b><br>ATçµ‚äº†ç”»é¢ã§é«˜è¨­å®šç¤ºå”†ï¼»å¼±ï¼½ã¨ãªã‚‹ã®ã¯èª°ï¼Ÿ",
    c:["äºœé–€é‹¼å¤ªæœ—ï¼†çœŸæˆ¸æš","ç¥ä»£åˆ©ä¸–","ç¬›å£é››å®Ÿï¼†ç¬›å£ãƒªãƒ§ãƒ¼ã‚³","é‡‘æœ¨ç ”ï¼†éœ§å¶‹è‘£é¦™"],
    a:2,
    img:"images/gu-ru_AT.jpg",},

    {type:"choice", q:"<b>ã€ã‚¹ãƒã‚¹ãƒ­ Læ±äº¬å–°ç¨®ã€</b><br>æœˆå±±æ‹›å¾…çŠ¶æ¼”å‡ºã€Œæœ¬ã¯ã„ã„ã‚ˆã­â€¦ã€ã®è¨­å®šç¤ºå”†ã¯ã©ã‚Œï¼Ÿ",
    c:["è¨­å®š1å¦å®š","è¨­å®š2å¦å®š","è¨­å®š3å¦å®š","è¨­å®š4å¦å®š"],
    a:2,
    img:"images/gu-ru_honha.jpg",},

    {type:"choice", q:"<b>ã€ã‚¹ãƒã‚¹ãƒ­ Læ±äº¬å–°ç¨®ã€</b><br>å–°ç¨®å¯¾æ±ºã«ã¦ã€æˆåŠŸæœŸå¾…åº¦ãŒä¸€ç•ªé«˜ã„ã®ã¯æ¬¡ã®å†…ã©ã‚Œï¼Ÿ",
    c:["äºœé–€","ãƒ¤ãƒ¢ãƒª","éœ§å¶‹çµ¢éƒ½","ç‰¹ç­‰ã‚‰"],
    a:0,
    img:"images/gu-ru_batoru.jpg",},

    {type:"text", q:"<b>ã€ã‚¹ãƒã‚¹ãƒ­ Læ±äº¬å–°ç¨®ã€</b><br>ãƒãƒˆãƒ«å‹åˆ©å¾Œã€BITESã¸è¡Œã‹ãšã«æ˜‡æ ¼ã‚¾ãƒ¼ãƒ³ã«è¡Œã‘ã°å¤§ãƒãƒ£ãƒ³ã‚¹ã ãŒã€ãã®æ˜‡æ ¼ã‚¾ãƒ¼ãƒ³ã®åå‰ã¯ï¼Ÿ<br>ğŸš«å®Œç­”ã§1ãƒã‚¤ãƒ³ãƒˆ",
    a:["ã“ã®ä¸–ã®ã™ã¹ã¦ã®ä¸åˆ©ç›Šã¯å½“äººã®èƒ½åŠ›ä¸è¶³"],
    correctImg:"images/gu-ru_konoyo.jpg",},

    {type:"choice", q:"<b>ã€ãƒ‘ãƒã‚¹ãƒ­ ç”²é‰„åŸã®ã‚«ãƒãƒãƒªã€</b><br>ç¾é¦¬CZä¸­ã®ãƒªãƒ—ãƒ¬ã‚¤ã¨ãƒ™ãƒ«ã§ã®ãƒœãƒ¼ãƒŠã‚¹å½“é¸ç‡ã¯ï¼Ÿ",
    c:["5%","8%","10%","12.5%"],
    a:2,
    img:"images/kaba_biba.jpg",},

    {type:"text", q:"<b>ã€ãƒ‘ãƒã‚¹ãƒ­ ç”²é‰„åŸã®ã‚«ãƒãƒãƒªã€</b><br>ç”Ÿé§’CZã®ãƒ©ã‚¤ãƒ•ã¯è¦‹ãŸç›®ä¸Š3å€‹ã ãŒã€CZã‚¹ã‚¿ãƒ¼ãƒˆæ™‚ã¯å†…éƒ¨çš„ã«ä½•å€‹ã‹ã‚‰ã‚¹ã‚¿ãƒ¼ãƒˆã—ã¦ã„ã‚‹ï¼Ÿ",
    a:["5","5å€‹"],
    img:"images/kaba_iko.jpg",},

    {type:"choice", q:"<b>ã€ãƒ‘ãƒã‚¹ãƒ­ ç”²é‰„åŸã®ã‚«ãƒãƒãƒªã€</b><br>STä¸­ã®ãƒœãƒ¼ãƒŠã‚¹ç´¯è¨ˆç²å¾—ãŒå¹³å‡ä½•æšã«åˆ°é”ã—ãŸã‚‰æ¬¡ã®ãƒœãƒ¼ãƒŠã‚¹ãŒç‡ƒãˆã‚‹å‘½ã«å¤‰åŒ–ã™ã‚‹ï¼Ÿ",
    c:["1059","1069","1079","1089"],
    a:1,
    img:"images/kaba_moe.jpg",},

    {type:"choice", q:"<b>ã€ãƒ‘ãƒã‚¹ãƒ­ ç”²é‰„åŸã®ã‚«ãƒãƒãƒªã€</b><br>é§¿åŸãƒœãƒ¼ãƒŠã‚¹ä¸­ã®ãƒ¡ãƒ¼ã‚¿ãƒ¼ãŒç·‘è‰²ã ã£ãŸå ´åˆã®STå½“é¸æœŸå¾…åº¦ã¯ï¼Ÿ",
    c:["19.7%","20.7%","21.7%","22.7%"],
    a:2,
    img:"images/kaba_hayajiro.jpg",},

    {type:"choice", q:"<b>ã€ã‚¹ãƒã‚¹ãƒ­ ã‚´ãƒƒãƒ‰ã‚¤ãƒ¼ã‚¿ãƒ¼ ãƒªã‚¶ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã€</b><br>ATçµ‚äº†ç”»é¢ã§è¨­å®š2ãƒ»3ãƒ»4å¦å®šã®ã‚­ãƒ£ãƒ©ã¯ï¼Ÿ",
    c:["ãƒªãƒ³ãƒ‰ã‚¦","ã‚¢ãƒªã‚µ","ã‚­ãƒ£ãƒ©é›†åˆ","ãƒ¦ã‚¦"],
    a:3,
    img:"images/god_AT.jpg",},

    {type:"text", q:"<b>ã€ã‚¹ãƒã‚¹ãƒ­ ã‚´ãƒƒãƒ‰ã‚¤ãƒ¼ã‚¿ãƒ¼ ãƒªã‚¶ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã€</b><br>ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ãƒ‘ãƒ¼ãƒˆçµ‚äº†æ™‚ã€ã‚µãƒ–æ¶²æ™¶ã«ã‚¿ãƒƒãƒã™ã‚‹ã¨ãƒœã‚¤ã‚¹ãŒèã‘ã‚‹ãŒã€ã‚³ã‚¦ã‚¿ã¯ã€Œä¸€ç·’ã«ã€‡ã€‡è¦‹ã‚ˆã†ãœï¼ã€ã¨è¨€ã£ã¦ã„ã‚‹ã€‚ä¸€ç·’ã«ä½•ã‚’è¦‹ãŸãŒã£ã¦ã‚‹ï¼Ÿ",
    a:["ãƒã‚¬ãƒ©ãƒªãƒ¼"],
    img:"images/god_sub.jpg",},

    {type:"choice", q:"<b>ã€ã‚¹ãƒã‚¹ãƒ­ ã‚´ãƒƒãƒ‰ã‚¤ãƒ¼ã‚¿ãƒ¼ ãƒªã‚¶ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã€</b><br>ã‚¢ãƒ©ã‚¬ãƒŸäº¤æˆ¦ã«ã¦ã€ã‚«ãƒªã‚®ãƒ¥ãƒ©ã®å¼±ç‚¹ã¯ä½•ï¼Ÿ",
    c:["ãƒãƒ£ãƒ³ã‚¹ç›®","ã‚¹ã‚¤ã‚«","ãƒã‚§ãƒªãƒ¼","ç„¡ã—"],
    a:2,
    img:"images/god_aragami.jpg",},

    {type:"choice", q:"<b>ã€ã‚¹ãƒã‚¹ãƒ­ ã‚´ãƒƒãƒ‰ã‚¤ãƒ¼ã‚¿ãƒ¼ ãƒªã‚¶ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã€</b><br>é€†é±—ãƒãƒ³ãƒ‹ãƒãƒ«è¨ä¼æˆ¦ã®ç™ºç”Ÿæ¡ä»¶ã¯ï¼Ÿ",
    c:["ä¸€åº¦ã®ATã§5å›ãƒãƒ³ãƒ‹ãƒãƒ«ã«å‹åˆ©","å‹åˆ©ã‚¹ãƒˆãƒƒã‚¯ç²å¾—ã§ç™ºç”Ÿ","ã‚¢ãƒ©ã‚¬ãƒŸäº¤æˆ¦ã§ã‚ªãƒ¼ãƒãƒ¼ã‚­ãƒ«ã‚’ã—ãŸå ´åˆã«ç™ºç”Ÿ","ä¸€åº¦ã®ATã§1000æšä»¥ä¸Šç²å¾—"],
    a:3,
    img:"images/god_gekirin.jpg",},

    {type:"choice", q:"<b>ã€ã‚¹ãƒã‚¹ãƒ­ ãƒ‡ãƒ“ãƒ« ãƒ¡ã‚¤ ã‚¯ãƒ©ã‚¤5ã€</b><br>ãƒœãƒ¼ãƒŠã‚¹çµ‚äº†ç”»é¢ã§ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆç¤ºå”†ãªã®ã¯ã€æ¬¡ã®å†…ã©ã‚Œï¼Ÿ",
    c:["é­”ç•Œ","ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãƒ¼","ãƒ‹ã‚³ãƒˆãƒ¬ãƒ¼ãƒ©ãƒ¼å†…","ãƒãƒ¼ã‚±ãƒƒãƒˆ"],
    a:2,
    img:"images/DMC_niko.jpg",},

    {type:"text", q:"<b>ã€ã‚¹ãƒã‚¹ãƒ­ ãƒ‡ãƒ“ãƒ« ãƒ¡ã‚¤ ã‚¯ãƒ©ã‚¤5ã€</b><br>ã‚³ãƒ©ãƒœãƒãƒ£ãƒ³ã‚¹ã®ã‚­ãƒ£ãƒ©è¨­å®šæ™‚ã«3.1%ã§ç™ºç”Ÿã™ã‚‹ç”»åƒã®ã‚­ãƒ£ãƒ©ã¯èª°ï¼Ÿ",
    a:["ã‚¹ãƒ¼ãƒ‘ãƒ¼ãƒãƒ­"],
    img:"images/DMC_nero.jpg",},

    {type:"text", q:"<b>ã€ã‚¹ãƒã‚¹ãƒ­ ãƒ‡ãƒ“ãƒ« ãƒ¡ã‚¤ ã‚¯ãƒ©ã‚¤5ã€</b><br>STä¸­ã«ä½•æšä»¥ä¸Šç²å¾—ã™ã‚Œã°ãƒ¦ãƒªã‚¼ãƒ³ãƒãƒˆãƒ«ã«çªå…¥ã™ã‚‹ï¼Ÿ",
    a:["500","500æš"],
    img:"images/DMC_yurizen.jpg",},

    {type:"text", q:"<b>ã€ã‚¹ãƒã‚¹ãƒ­ ãƒ‡ãƒ“ãƒ« ãƒ¡ã‚¤ ã‚¯ãƒ©ã‚¤5ã€</b><br>ç”»åƒã®ãŠã˜ã•ã‚“ã¯èª°ï¼Ÿ",
    a:["ãƒ€ãƒ³ãƒ‡"],
    img:"images/DMC_dande.jpg",},

    {type:"choice", q:"<b>ã€ã‚¹ãƒã‚¹ãƒ­ ã‹ãã‚„æ§˜ã¯å‘Šã‚‰ã›ãŸã„ã€</b><br>ãƒŸãƒ‹è—¤åŸãŒç”»åƒã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã§è¡£è£…ãƒã‚§ãƒ³ã‚¸ã—ãŸå ´åˆã€è¨­å®šç¤ºå”†ã¯ã„ãã¤ï¼Ÿ",
    c:["è¨­å®š2ä»¥ä¸Šæ¿ƒåš","è¨­å®š3ä»¥ä¸Šæ¿ƒåš","è¨­å®š4ä»¥ä¸Šæ¿ƒåš","è¨­å®š6æ¿ƒåš"],
    a:2,
    img:"images/kaguya_tika.jpg",},

    {type:"choice", q:"<b>ã€ã‚¹ãƒã‚¹ãƒ­ ã‹ãã‚„æ§˜ã¯å‘Šã‚‰ã›ãŸã„ã€</b><br>ç”»åƒã®æ¼”å‡ºã®æˆåŠŸæœŸå¾…åº¦ã¯ï¼Ÿ",
    c:["ç´„62%","ç´„72%","ç´„82%","ç´„92%"],
    a:2,
    img:"images/kaguya_hanabi.jpg",},

    {type:"text", q:"<b>ã€ã‚¹ãƒã‚¹ãƒ­ ã‹ãã‚„æ§˜ã¯å‘Šã‚‰ã›ãŸã„ã€</b><br>å‘Šã‚‰ã›ãŸã„ãƒãƒ£ãƒ¬ãƒ³ã‚¸[CZ]ä¸­ã«ç™ºç”Ÿã™ã‚‹ç”»åƒã®æ¼”å‡ºåã¯ä½•ï¼Ÿ",
    a:["ä¸€ç™ºå‘ŠçŸ¥"],
    img:"images/kaguya_koku.jpg",},

    {type:"text", q:"<b>ã€ã‚¹ãƒã‚¹ãƒ­ ã‹ãã‚„æ§˜ã¯å‘Šã‚‰ã›ãŸã„ã€</b><br>å¥‡è·¡çš„ç›¸æ€§ã®èª­ã¿æ–¹ã¯ï¼Ÿ",
    a:["ãƒãƒªã‚¢ãƒ¼ã‚¸ãƒ¥"],
    img:"images/kaguya_mari.jpg",},


  ],
  js:[
    {type:"text", q:"JavaScriptã§å¤‰æ•°ã‚’å®£è¨€ã™ã‚‹ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã¯ï¼Ÿ", a:["let","const","var"]},
    {type:"choice", q:"é…åˆ—ã®æ·»å­—ã¯ä½•ã‹ã‚‰ï¼Ÿ", c:["0","1"], a:0}
  ]
};

/* ===== state ===== */
let quiz=[], index=0, score=0, locked=false;
let currentGenre = "";

/* ===== elements ===== */
const screens=document.querySelectorAll(".screen");
const genreScreen=document.getElementById("genreScreen");
const quizScreen=document.getElementById("quizScreen");
const resultScreen=document.getElementById("resultScreen");
const titleScreen = document.getElementById("titleScreen");

const qEl=document.getElementById("question");
const cEl=document.getElementById("choices");
const feedbackEl=document.getElementById("feedback");
const progressEl=document.getElementById("progress");
const scoreEl=document.getElementById("score");

const submitBtn=document.getElementById("submitBtn");
const nextBtn=document.getElementById("nextBtn");

const titleEl=document.getElementById("title");
const resultText=document.getElementById("resultText");

/* ===== util ===== */
// ã‚¹ã‚¿ãƒ¼ãƒˆãƒœã‚¿ãƒ³æŠ¼ä¸‹æ™‚
function goToGenre(){
  playSE("seStart");
  if(navigator.vibrate){ navigator.vibrate(60); }

    // ã¾ãšã‚¿ã‚¤ãƒˆãƒ«ç”»é¢ã‚’å³æ¶ˆã™
  titleScreen.classList.remove("active");

  document.body.classList.add("flash");
  setTimeout(() => {
    document.body.classList.remove("flash");
    show(genreScreen); // ã‚¿ã‚¤ãƒˆãƒ«ç”»é¢æ¶ˆã—ã¦ã‚¸ãƒ£ãƒ³ãƒ«è¡¨ç¤º
  }, 300);
}

// ç”»é¢åˆ‡ã‚Šæ›¿ãˆ
function show(screen){
  screens.forEach(s => s.classList.remove("active")); // å…¨ç”»é¢éè¡¨ç¤º
  screen.classList.add("active");                     // æŒ‡å®šç”»é¢è¡¨ç¤º
}


function normalize(str){
  return str.trim().toLowerCase();
}

function playSE(id){
  const se = document.getElementById(id);
  if(!se) return;
  se.currentTime = 0;
  se.play();
}

function playResultSE(){
  if(score === quiz.length){
    playSE("sePerfect");
    rainbowEffect();
  }else if(score >= 18){
    playSE("seGood");
  }else if(score >= 6){
    playSE("seBad");
  }else{
    playSE("seHell");
  }
}

function vibrateResult(){
  if(!navigator.vibrate) return;

  if(score === quiz.length){
    navigator.vibrate([100,50,100,50,200]);
  }else if(score >= 18){
    navigator.vibrate([80,40,80]);
  }else if(score >= 6){
    navigator.vibrate(200);
  }else{
    navigator.vibrate([300,100,300]);
  }
}

/* ===== start ===== */
function startQuiz(type){
  playSE("seSelect");

  currentGenre = type;
  quiz = shuffle([...QUIZ_DATA[type]]); // â†ã“ã“ã§ãƒ©ãƒ³ãƒ€ãƒ åŒ–
  index = 0;
  score = 0;
  show(quizScreen);
  loadQuestion();
}

/* ===== load ===== */
function loadQuestion(){
  locked=false;
  feedbackEl.innerHTML="";
  cEl.innerHTML="";
  submitBtn.style.display="none";
  nextBtn.style.display="none";

  const q = quiz[index];

  // å•é¡Œæ–‡
  qEl.innerHTML = q.q;

  // å•é¡Œç”»åƒ
  if(q.img){
    const image = document.createElement("img");
    image.src = q.img;
    image.style.maxWidth = "100%";
    image.style.margin = "12px 0";
    cEl.appendChild(image); // é¸æŠè‚¢ã®ä¸Šã«ç½®ã
  }

  progressEl.textContent = `${index+1} / ${quiz.length}`;
  scoreEl.textContent = `Score: ${score}`;

  if(q.type==="choice"){
    q.c.forEach((text,i)=>{
      const btn=document.createElement("button");
      btn.className="choice";
      btn.textContent=text;
      btn.onclick=()=>selectChoice(btn,i);
      cEl.appendChild(btn);
    });
  }

  if(q.type==="text"){
    const input=document.createElement("input");
    input.id="textAnswer";
    input.placeholder="ç­”ãˆã‚’å…¥åŠ›";
    cEl.appendChild(input);
    submitBtn.style.display="block";
  }
}

/* ===== choice ===== */
function selectChoice(btn,i){
  if(locked) return;
  locked=true;

  const q=quiz[index];
  const buttons=document.querySelectorAll(".choice");

  buttons.forEach((b,idx)=>{
    if(idx===q.a) b.classList.add("correct");
    if(idx===i && i!==q.a) b.classList.add("wrong");
    b.disabled=true;
  });

  if(i===q.a){
    score++;
    feedbackEl.textContent="æ­£è§£ï¼";
    feedbackEl.style.color="#16a34a";

    playSE("seCorrect");

      // æ­£è§£ç”»åƒãŒã‚ã‚Œã°è¡¨ç¤º
  if(q.correctImg){
    const img = document.createElement("img");
    img.src = q.correctImg;
    img.style.maxWidth = "100%";
    img.style.marginTop = "12px";
    feedbackEl.appendChild(img); // æ­£è§£æ–‡å­—ã®ä¸‹ã«è¡¨ç¤º
  }

      // â˜… æ­£è§£ãƒ•ãƒ©ãƒƒã‚·ãƒ¥æ¼”å‡º
  document.body.classList.add("flash");
  setTimeout(()=>document.body.classList.remove("flash"),400);

  }else{
    feedbackEl.textContent="ä¸æ­£è§£";
    feedbackEl.style.color="#dc2626";

    playSE("seWrong");

      // â˜… ä¸æ­£è§£æºã‚Œæ¼”å‡º
  wrongEffect();
  }

  nextBtn.style.display="block";
}

/* ===== text ===== */
submitBtn.onclick=()=>{
  if(locked) return;
  locked=true;

  const q=quiz[index];
  const input=document.getElementById("textAnswer").value;
  const user=normalize(input);
  const answers=q.a.map(normalize);

  if(answers.includes(user)){
    score++;
    feedbackEl.textContent="æ­£è§£ï¼";
    feedbackEl.style.color="#16a34a";

    playSE("seCorrect");

      // â˜… æ­£è§£ãƒ•ãƒ©ãƒƒã‚·ãƒ¥æ¼”å‡º
  document.body.classList.add("flash");
  setTimeout(()=>document.body.classList.remove("flash"),400);

    // â˜… æ­£è§£ç”»åƒãŒã‚ã‚Œã°è¡¨ç¤º
  if(q.correctImg){
    const img = document.createElement("img");
    img.src = q.correctImg;
    img.style.maxWidth = "100%";
    img.style.marginTop = "12px";
    feedbackEl.appendChild(img); // æ­£è§£æ–‡å­—ã®ä¸‹ã«è¡¨ç¤º
  }

  }else{
    feedbackEl.innerHTML=`
      ä¸æ­£è§£<br>
      <span style="font-size:14px;color:#555;">
        æ­£è§£ï¼š${q.a.join(" / ")}
      </span>
    `;
    feedbackEl.style.color="#dc2626";

    playSE("seWrong");
      // â˜… ä¸æ­£è§£æºã‚Œæ¼”å‡º
  wrongEffect();
  }

  nextBtn.style.display="block";
};

/* ===== next ===== */
nextBtn.onclick = ()=>{
  const isLast = index === quiz.length - 1;

  if(isLast){
    if(score === quiz.length){
      playSE("sePerfect");
    }else if(score >= 18){
      playSE("seGood");
    }else if(score >= 6){
      playSE("seBad");
    }else{
      playSE("seHell");
    }
  }

  index++;

  if(index >= quiz.length){
    vibrateResult();
    showResult();
  }else{
    loadQuestion();
  }
};



/* ===== result ===== */
function wrongEffect(){
  document.body.classList.add("shake");
  setTimeout(()=>document.body.classList.remove("shake"),400);
}

function showResult(){
  show(resultScreen);

  titleEl.textContent = "";
  resultText.textContent = "";

let title = "";

if(score === quiz.length){
  title = "ğŸ‘‘ ç¥å¼•ãã‚¹ãƒ­ãƒƒã‚¿ãƒ¼";
}else if(score >= 24){
  title = "ğŸ”¥ ä¸Šä½ATå¸¸é§";
}else if(score >= 18){
  title = "ğŸ’° æœŸå¾…å€¤è¿½ã£ã¦ã‚‹äºº";
}else if(score >= 12){
  title = "âš™ï¸ å˜ç™ºãƒ«ãƒ¼ãƒ—";
}else if(score >= 6){
  title = "ğŸ’€ å¤©äº•å˜ç™º";
}else{
  title = "ğŸ’¸ é¤Šåˆ†";
}

  // å°‘ã—é–“ã‚’ç½®ã„ã¦SE


  // ä¸€æ‹ãŠã
  setTimeout(()=>{
    titleEl.textContent = title;
    titleEl.classList.remove("title-animate");
    void titleEl.offsetWidth; // å†ç™ºç«
    titleEl.classList.add("title-animate");
  }, 500);

  // ã•ã‚‰ã«å°‘ã—å¾Œã«ã‚¹ã‚³ã‚¢è¡¨ç¤º
  setTimeout(()=>{
    resultText.textContent = `${score} / ${quiz.length} æ­£è§£`;
  }, 1300);
}

function restartQuiz(){
  index = 0;
  score = 0;
  locked = false;
  quiz = shuffle([...QUIZ_DATA[currentGenre]]);
  show(quizScreen);
  loadQuestion();
}

function backToGenre(){
  quiz = [];
  index = 0;
  score = 0;
  locked = false;
  currentGenre = ""; // â† ã“ã“ã ã‘ãƒªã‚»ãƒƒãƒˆ

  show(genreScreen);
}

function shuffle(array){
  for(let i = array.length - 1; i > 0; i--){
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
  return array;
}

function rainbowEffect(){
  document.body.classList.add("rainbow");
  setTimeout(()=>{
    document.body.classList.remove("rainbow");
  }, 2000);
}

//ãƒã‚¤ãƒ–//
function vibrate(pattern){
  if(navigator.vibrate){
    navigator.vibrate(pattern);
  }
}

</script>
</body>
</html>
